<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Importación - Importaciones Yesica</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #007bff; /* Azul vibrante */
            --secondary-color: #6c757d; /* Gris secundario */
            --accent-color: #28a745; /* Verde para destacados */
            --text-color: #343a40;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --border-color: #e9ecef;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Alinea arriba */
            min-height: 100vh;
            padding: 30px 15px;
            margin: 0;
            box-sizing: border-box;
        }

        .container {
            background-color: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            border-top: 5px solid var(--primary-color);
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-weight: 700;
            font-size: 2.2em;
        }

        .input-group {
            margin-bottom: 20px;
            position: relative; /* Para el autocomplete */
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95em;
        }

        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1em;
            color: var(--text-color);
            transition: border-color 0.2s;
        }

        input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }

        .autocomplete-items {
            position: absolute;
            border: 1px solid var(--border-color);
            border-top: none;
            z-index: 99;
            top: 100%; /* Justo debajo del input */
            left: 0;
            right: 0;
            background-color: var(--card-bg);
            max-height: 200px;
            overflow-y: auto;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 5px 10px rgba(0,0,0,0.05);
        }

        .autocomplete-items div {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.95em;
            color: var(--text-color);
        }

        .autocomplete-items div:hover {
            background-color: var(--bg-color);
        }

        button {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2);
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        .results-section {
            margin-top: 30px;
            padding: 25px;
            background-color: var(--bg-color);
            border-radius: 10px;
            border: 1px solid var(--border-color);
            display: none; /* Oculto por defecto */
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1em;
            color: var(--text-color);
        }
        .result-item strong { color: var(--primary-color); }
        
        .total-summary {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed var(--border-color);
            text-align: center;
        }
        .total-label {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 8px;
        }
        .total-amount {
            font-size: 2.2em;
            font-weight: 700;
            color: var(--accent-color); /* Verde para el total */
            display: block;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>IMPORTACIONES YESICA</h1>
    
    <div class="input-group">
        <label for="subasta">Precio de Martillo (Subasta):</label>
        <input type="number" id="subasta" placeholder="$0.00" oninput="clearSelection()">
    </div>

    <div class="input-group">
        <label for="busquedaGrua">Buscar Ubicación de Grúa (Copart):</label>
        <input type="text" id="busquedaGrua" placeholder="Escribe ciudad, estado (ej. Miami, FL)..." autocomplete="off">
        <div id="listaSugerencias" class="autocomplete-items"></div>
    </div>

    <button onclick="calcular()">CALCULAR PRESUPUESTO</button>

    <div id="resultado" class="results-section">
        <div class="result-item"><span>Precio Subasta + $700:</span> <strong><span id="valCompra"></span></strong></div>
        <div class="result-item"><span>Flete Total (Marítimo + Grúa):</span> <strong><span id="valFlete"></span></strong></div>
        <div class="result-item"><span>Total Impuestos:</span> <strong><span id="valImpuestos"></span></strong></div>
        <div class="result-item"><span>Gastos Fijos de Gestión:</span> <strong>$350.00</strong></div>
        
        <div class="total-summary">
            <span class="total-label">GRAN TOTAL A PAGAR:</span>
            <span class="total-amount" id="resTotal"></span>
        </div>
    </div>
</div>

<script>
// Base de datos completa de grúas (Copart) extraída de tus imágenes
const ubicaciones = [
    // --- LISTA FLORIDA (Puerto Marítimo $750) ---
    { nombre: "Miami Central (FL)", grua: 100, puerto: 750 },
    { nombre: "Miami North (FL)", grua: 100, puerto: 750 },
    { nombre: "Miami South (FL)", grua: 100, puerto: 750 },
    { nombre: "Orlando North (FL)", grua: 175, puerto: 750 },
    { nombre: "Orlando South (FL)", grua: 175, puerto: 750 },
    { nombre: "West Palm Beach (FL)", grua: 120, puerto: 750 },
    { nombre: "Tampa North (FL)", grua: 225, puerto: 750 },
    { nombre: "Tampa South (FL)", grua: 205, puerto: 750 },
    { nombre: "Jacksonville North (FL)", grua: 250, puerto: 750 },
    { nombre: "Punta Gorda (FL)", grua: 220, puerto: 750 },
    { nombre: "Tallahassee (FL)", grua: 320, puerto: 750 },
    { nombre: "Ocala (FL)", grua: 250, puerto: 750 },
    { nombre: "Clewiston (FL)", grua: 175, puerto: 750 },
    { nombre: "Atlanta West (GA)", grua: 345, puerto: 750 },
    { nombre: "Savannah (GA)", grua: 345, puerto: 750 },
    { nombre: "Houston (TX)", grua: 550, puerto: 750 },
    { nombre: "Dallas (TX)", grua: 500, puerto: 750 },
    { nombre: "San Antonio (TX)", grua: 500, puerto: 750 },
    { nombre: "Charlotte (NC)", grua: 400, puerto: 750 },
    { nombre: "Nashville (TN)", grua: 480, puerto: 750 },
    { nombre: "Louisville (KY)", grua: 675, puerto: 750 },
    { nombre: "Birmingham (AL)", grua: 485, puerto: 750 },
    { nombre: "Mobile (AL)", grua: 475, puerto: 750 },

    // --- LISTA PHILADELPHIA (Puerto Marítimo $825) ---
    { nombre: "Philadelphia (PA)", grua: 145, puerto: 825 },
    { nombre: "Harrisburg (PA)", grua: 170, puerto: 825 },
    { nombre: "York Haven (PA)", grua: 175, puerto: 825 },
    { nombre: "Chambersburg (PA)", grua: 220, puerto: 825 },
    { nombre: "Altoona (PA)", grua: 330, puerto: 825 },
    { nombre: "Glassboro East/West (NJ)", grua: 150, puerto: 825 },
    { nombre: "Somerville (NJ)", grua: 180, puerto: 825 },
    { nombre: "Trenton Jobstown (NJ)", grua: 225, puerto: 825 },
    { nombre: "Long Island (NY)", grua: 325, puerto: 825 },
    { nombre: "Newburgh (NY)", grua: 270, puerto: 825 },
    { nombre: "Baltimore East (MD)", grua: 235, puerto: 825 },
    { nombre: "Washington DC", grua: 225, puerto: 825 },
    { nombre: "Hartford Springfield (CT)", grua: 300, puerto: 825 },
    { nombre: "New Britain (CT)", grua: 275, puerto: 825 },
    { nombre: "Seaford Fruitland (DE)", grua: 300, puerto: 825 },
    { nombre: "Chicago North/South (IL)", grua: 650, puerto: 825 },
    { nombre: "Detroit (MI)", grua: 750, puerto: 825 },
    { nombre: "Minneapolis (MN)", grua: 775, puerto: 825 },
    { nombre: "Madison (WI)", grua: 775, puerto: 825 },
    { nombre: "Columbus (OH)", grua: 575, puerto: 825 }
];

let seleccionada = null; // Para guardar la ubicación de grúa elegida

const inputBusqueda = document.getElementById("busquedaGrua");
const listaSugerencias = document.getElementById("listaSugerencias");

// Evento para mostrar sugerencias al escribir
inputBusqueda.addEventListener("input", function() {
    const val = this.value.toLowerCase();
    listaSugerencias.innerHTML = ""; // Limpiar sugerencias anteriores
    seleccionada = null; // Limpiar selección previa

    if (!val) {
        listaSugerencias.style.display = 'none';
        return;
    }

    const filtradas = ubicaciones.filter(u => u.nombre.toLowerCase().includes(val));
    
    if (filtradas.length > 0) {
        listaSugerencias.style.display = 'block';
        filtradas.forEach(u => {
            const div = document.createElement("div");
            div.innerHTML = u.nombre;
            div.addEventListener("click", function() {
                inputBusqueda.value = u.nombre;
                seleccionada = u; // Guarda la ubicación seleccionada
                listaSugerencias.innerHTML = "";
                listaSugerencias.style.display = 'none';
            });
            listaSugerencias.appendChild(div);
        });
    } else {
        listaSugerencias.style.display = 'none';
    }
});

// Limpiar sugerencias si el usuario hace clic fuera
document.addEventListener("click", function (e) {
    if (e.target != inputBusqueda) {
        listaSugerencias.innerHTML = "";
        listaSugerencias.style.display = 'none';
    }
});

// Limpiar selección si el usuario edita el input de subasta
function clearSelection() {
    seleccionada = null;
    inputBusqueda.value = "";
}

function calcular() {
    const subasta = parseFloat(document.getElementById("subasta").value);

    if (isNaN(subasta) || subasta <= 0) {
        alert("Por favor, ingresa un precio de subasta válido.");
        return;
    }
    if (!seleccionada) {
        alert("Por favor, selecciona una ubicación de grúa de la lista.");
        return;
    }

    // 1. Lógica de Negocio
    const valorCompraBase = subasta + 700; // Precio Subasta + $700 fijos
    const fleteTotal = seleccionada.grua + seleccionada.puerto; // Grúa + Marítimo
    const cif = valorCompraBase + fleteTotal; // Base Imponible CIF

    // 2. Impuestos Aduaneros (fórmulas deducidas de tus capturas)
    const dai = cif * 0.25; // 25% del CIF
    const iva = (cif + dai) * 0.13; // 13% de (CIF + DAI)
    const aiv = cif * 0.01; // 1% del CIF
    const matricula = cif * 0.0569; // ~5.69% del CIF (Primera Mat.)
    const pe = 40.00; // Cargo fijo PE
    const totalImpuestos = dai + iva + aiv + matricula + pe;

    // 3. Gran Total (incluye los $350 finales)
    const gastosFijosFinales = 350.00;
    const granTotalFinal = valorCompraBase + fleteTotal + totalImpuestos + gastosFijosFinales;

    // Mostrar Resultados en la Interfaz
    document.getElementById('valCompra').innerText = `$${valorCompraBase.toFixed(2)}`;
    document.getElementById('valFlete').innerText = `$${fleteTotal.toFixed(2)}`;
    document.getElementById('valImpuestos').innerText = `$${totalImpuestos.toFixed(2)}`;
    document.getElementById('resTotal').innerText = `$${granTotalFinal.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
    
    document.getElementById('resultado').style.display = 'block'; // Mostrar la sección de resultados
}
</script>

</body>
</html>